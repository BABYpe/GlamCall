import{j as e}from"./index-D2UFHVmt.js";import{r as t}from"./react-vendor-D92mXBJ3.js";import{X as a,x as l,Y as r,_ as s,V as n,$ as i,a0 as o,y as c,a1 as d,a2 as m,a3 as h,f as u,e as g,p,M as x,a4 as b,a as v,W as f}from"./ui-vendor-CXUW7VoX.js";import"./seo-vendor-CXpkBIGe.js";import"./query-vendor-BU1JGbmk.js";import"./i18n-vendor-ClAPDSrk.js";import"./toast-vendor-D26nLpGL.js";import"./supabase-vendor-BBsrQuQX.js";const N=({isOpen:s,onClose:n,modelName:i,modelAvatar:o,onSendGift:c})=>{const[d,m]=t.useState([{id:"1",sender:"model",content:"Hi there! Thanks for joining my stream! ðŸ’•",timestamp:new Date(Date.now()-3e5),type:"text"},{id:"2",sender:"user",content:"Hello! You look amazing today!",timestamp:new Date(Date.now()-24e4),type:"text"},{id:"3",sender:"model",content:"Aww thank you so much! You're so sweet! ðŸ˜Š",timestamp:new Date(Date.now()-18e4),type:"text"}]),[h,u]=t.useState(""),[g,p]=t.useState(!1),x=t.useRef(null);t.useEffect(()=>{b()},[d]);const b=()=>{var e;null==(e=x.current)||e.scrollIntoView({behavior:"smooth"})},v=()=>{if(h.trim()){const e={id:Date.now().toString(),sender:"user",content:h,timestamp:new Date,type:"text"};m(t=>[...t,e]),u(""),setTimeout(()=>{const e=["Thank you! ðŸ˜˜","You're so kind! ðŸ’•","I love chatting with you! âœ¨","That made my day! ðŸ¥°","You always know what to say! ðŸ’–"],t=e[Math.floor(Math.random()*e.length)],a={id:""+(Date.now()+1),sender:"model",content:t,timestamp:new Date,type:"text"};m(e=>[...e,a])},1e3+2e3*Math.random())}};return s?e.jsxs("div",{className:"fixed inset-y-0 right-0 w-80 bg-gray-900/95 backdrop-blur-xl border-l border-gray-700/50 z-50 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700/50",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:o,alt:i,className:"w-8 h-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-semibold",children:i}),e.jsx("p",{className:"text-green-400 text-xs",children:"Online"})]})]}),e.jsx("button",{onClick:n,className:"p-1 text-gray-400 hover:text-white transition-colors",children:e.jsx(a,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:[d.map(t=>{return e.jsx("div",{className:"flex "+("user"===t.sender?"justify-end":"justify-start"),children:e.jsxs("div",{className:"max-w-[80%] "+("user"===t.sender?"order-2":"order-1"),children:["model"===t.sender&&e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("img",{src:o,alt:i,className:"w-6 h-6 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-400",children:i})]}),e.jsxs("div",{className:"px-3 py-2 rounded-lg "+("user"===t.sender?"bg-purple-600 text-white":"gift"===t.type?"bg-gradient-to-r from-gold/20 to-yellow-500/20 border border-gold/30 text-gold":"bg-gray-700/50 text-white"),children:["gift"===t.type&&t.gift&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-2xl",children:t.gift.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:t.gift.name}),e.jsxs("div",{className:"text-xs opacity-75",children:["$",t.gift.value]})]})]}),"text"===t.type&&e.jsx("p",{className:"text-sm",children:t.content})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-1 text-center",children:(a=t.timestamp,a.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1}))})]})},t.id);var a}),e.jsx("div",{ref:x})]}),g&&e.jsxs("div",{className:"p-4 border-t border-gray-700/50 bg-gray-800/50",children:[e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[{id:"1",name:"Rose",value:1,icon:"ðŸŒ¹"},{id:"2",name:"Heart",value:2,icon:"ðŸ’–"},{id:"3",name:"Kiss",value:3,icon:"ðŸ’‹"},{id:"4",name:"Diamond",value:10,icon:"ðŸ’Ž"},{id:"5",name:"Crown",value:25,icon:"ðŸ‘‘"},{id:"6",name:"Champagne",value:50,icon:"ðŸ¾"}].map(t=>e.jsxs("button",{onClick:()=>(e=>{const t={id:Date.now().toString(),sender:"user",content:`Sent a ${e.name}!`,timestamp:new Date,type:"gift",gift:e};m(e=>[...e,t]),c(e),p(!1),setTimeout(()=>{const t=[`OMG! Thank you for the ${e.name}! You're amazing! ðŸ’•`,`Wow! A ${e.name}! You're so generous! ðŸ˜`,`Thank you so much for the ${e.name}! I love it! âœ¨`,`You're the best! Thanks for the ${e.name}! ðŸ¥°`],a=t[Math.floor(Math.random()*t.length)],l={id:""+(Date.now()+1),sender:"model",content:a,timestamp:new Date,type:"text"};m(e=>[...e,l])},1500)})(t),className:"flex flex-col items-center p-3 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"text-2xl mb-1",children:t.icon}),e.jsx("span",{className:"text-xs text-white",children:t.name}),e.jsxs("span",{className:"text-xs text-gold",children:["$",t.value]})]},t.id))}),e.jsx("button",{onClick:()=>p(!1),className:"w-full py-2 text-gray-400 hover:text-white text-sm transition-colors",children:"Close Gifts"})]}),e.jsx("div",{className:"p-4 border-t border-gray-700/50",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex-1 relative",children:e.jsx("input",{type:"text",value:h,onChange:e=>u(e.target.value),onKeyPress:e=>"Enter"===e.key&&v(),placeholder:"Type a message...",className:"w-full px-3 py-2 bg-gray-800/50 border border-gray-600 rounded-lg focus:ring-2 focus:ring-purple-500 text-white text-sm"})}),e.jsx("button",{onClick:()=>p(!g),className:"p-2 text-gold hover:text-yellow-400 transition-colors",children:e.jsx(l,{className:"w-5 h-5"})}),e.jsx("button",{onClick:v,disabled:!h.trim(),className:"p-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white rounded-lg transition-colors",children:e.jsx(r,{className:"w-5 h-5"})})]})})]}):null},y=({model:a,onEndCall:l,userBalance:r})=>{const[y,w]=t.useState(0),[k,C]=t.useState(!0),[j,D]=t.useState(!0),[$,M]=t.useState(!0),[T,Y]=t.useState(0),[S,I]=t.useState(0),[A,H]=t.useState(!1),[O,G]=t.useState(!1),[L,W]=t.useState("excellent"),[z,B]=t.useState(!1),[E,R]=t.useState("HD"),[V,q]=t.useState(!1),K=t.useRef(null);t.useEffect(()=>{const e=setInterval(()=>{w(t=>{const s=t+1,n=s/60*a.pricePerMinute;return Y(n),r>n||(clearInterval(e),l(s)),s})},1e3),t=setInterval(()=>{const e=["excellent","good","poor"];W(e[Math.floor(Math.random()*e.length)])},1e4);return()=>{clearInterval(e),clearInterval(t)}},[a.pricePerMinute,r,l]);const P=()=>{switch(L){case"excellent":return e.jsx(f,{className:"w-4 h-4 text-green-400"});case"good":return e.jsx(f,{className:"w-4 h-4 text-yellow-400"});case"poor":return e.jsx(v,{className:"w-4 h-4 text-red-400"})}},Q=()=>{switch(L){case"excellent":return"text-green-400";case"good":return"text-yellow-400";case"poor":return"text-red-400"}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"min-h-screen bg-black flex flex-col relative "+(A?"pr-80":""),children:[e.jsx("div",{className:"flex-1 relative",children:e.jsxs("div",{className:"w-full h-full relative",children:[e.jsx("video",{ref:K,className:"w-full h-full object-cover",poster:a.coverImage,autoPlay:!0,muted:!$}),e.jsx("div",{className:"absolute top-4 left-4 bg-black/70 backdrop-blur-lg rounded-lg px-3 py-2",children:e.jsxs("div",{className:"flex items-center space-x-2 text-white text-sm",children:[P(),e.jsx("span",{className:Q(),children:E}),e.jsx("span",{className:"text-gray-400",children:"â€¢"}),e.jsx("span",{className:Q(),children:L})]})}),V&&e.jsx("div",{className:"absolute top-4 right-4 bg-red-600/90 backdrop-blur-lg rounded-lg px-3 py-2",children:e.jsxs("div",{className:"flex items-center space-x-2 text-white text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),e.jsx("span",{children:"REC"})]})}),e.jsx("div",{className:"absolute bottom-20 right-4 w-40 h-28 bg-gray-800 rounded-lg overflow-hidden border-2 border-purple-500 shadow-lg",children:e.jsxs("div",{className:"w-full h-full bg-gradient-to-br from-purple-900 to-gray-900 flex items-center justify-center relative",children:[k?e.jsx("div",{className:"text-white text-xs",children:"Your Video"}):e.jsx(s,{className:"w-6 h-6 text-gray-400"}),e.jsx("div",{className:"absolute top-1 right-1 flex space-x-1",children:e.jsx("button",{onClick:()=>C(!k),className:"p-1 bg-black/50 rounded text-white hover:bg-black/70 transition-colors",children:k?e.jsx(n,{className:"w-3 h-3"}):e.jsx(s,{className:"w-3 h-3"})})})]})}),e.jsx("div",{className:"absolute bottom-4 left-4 bg-black/70 backdrop-blur-lg rounded-lg p-4 text-white min-w-[200px]",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-lg font-semibold",children:a.name}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-green-400 text-sm",children:"Live"})]})]}),e.jsx("div",{className:"text-2xl font-mono text-purple-400",children:(e=>{const t=Math.floor(e/3600),a=Math.floor(e%3600/60),l=e%60;return t>0?`${t}:${a.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`:`${a.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`})(y)}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Cost:"}),e.jsxs("span",{className:"text-gold",children:["$",T.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Balance:"}),e.jsxs("span",{className:"text-white",children:["$",(r-T).toFixed(2)]})]}),S>0&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Tips:"}),e.jsxs("span",{className:"text-green-400",children:["$",S.toFixed(2)]})]})]})]})}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity duration-300",children:e.jsxs("div",{className:"flex items-center space-x-4 bg-black/50 backdrop-blur-lg rounded-full px-6 py-3",children:[e.jsx("button",{onClick:()=>{document.fullscreenElement?(document.exitFullscreen(),G(!1)):(document.documentElement.requestFullscreen(),G(!0))},className:"p-3 bg-gray-700/50 hover:bg-gray-600/50 text-white rounded-full transition-all",children:O?e.jsx(i,{className:"w-5 h-5"}):e.jsx(o,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>B(!z),className:"p-3 bg-gray-700/50 hover:bg-gray-600/50 text-white rounded-full transition-all",children:e.jsx(c,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>q(!V),className:"p-3 rounded-full transition-all "+(V?"bg-red-600 hover:bg-red-700 text-white":"bg-gray-700/50 hover:bg-gray-600/50 text-white"),children:e.jsx(d,{className:"w-5 h-5"})})]})})]})}),e.jsx("div",{className:"bg-black/90 backdrop-blur-lg border-t border-gray-800 p-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-4",children:[e.jsx("button",{onClick:()=>C(!k),className:"p-4 rounded-full transition-all transform hover:scale-105 "+(k?"bg-gray-700 hover:bg-gray-600 text-white":"bg-red-600 hover:bg-red-700 text-white"),children:k?e.jsx(n,{className:"w-6 h-6"}):e.jsx(s,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>D(!j),className:"p-4 rounded-full transition-all transform hover:scale-105 "+(j?"bg-gray-700 hover:bg-gray-600 text-white":"bg-red-600 hover:bg-red-700 text-white"),children:j?e.jsx(m,{className:"w-6 h-6"}):e.jsx(h,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>M(!$),className:"p-4 rounded-full transition-all transform hover:scale-105 "+($?"bg-gray-700 hover:bg-gray-600 text-white":"bg-red-600 hover:bg-red-700 text-white"),children:$?e.jsx(u,{className:"w-6 h-6"}):e.jsx(g,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>{l(y)},className:"p-4 rounded-full bg-red-600 hover:bg-red-700 text-white transition-all transform hover:scale-105 shadow-lg",children:e.jsx(p,{className:"w-6 h-6 transform rotate-[135deg]"})}),e.jsx("button",{onClick:()=>H(!A),className:"p-4 rounded-full transition-all transform hover:scale-105 "+(A?"bg-purple-600 hover:bg-purple-700 text-white":"bg-gray-700 hover:bg-gray-600 text-white"),children:e.jsx(x,{className:"w-6 h-6"})}),e.jsx("button",{className:"p-4 rounded-full bg-gray-700 hover:bg-gray-600 text-white transition-all transform hover:scale-105",children:e.jsx(b,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2 bg-gray-800/50 px-3 py-2 rounded-lg",children:[P(),e.jsx("span",{className:"text-gray-300",children:"Connection: "}),e.jsx("span",{className:Q(),children:L})]}),e.jsxs("div",{className:"bg-gray-800/50 px-3 py-2 rounded-lg text-gray-300",children:["Quality: ",E]}),e.jsxs("div",{className:"bg-gray-800/50 px-3 py-2 rounded-lg text-gray-300",children:["Rate: $",a.pricePerMinute,"/min"]})]})]})}),z&&e.jsxs("div",{className:"absolute bottom-24 left-1/2 transform -translate-x-1/2 bg-gray-900/95 backdrop-blur-xl rounded-lg border border-gray-700 p-4 min-w-[300px]",children:[e.jsx("h3",{className:"text-white font-semibold mb-4",children:"Call Settings"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-300 text-sm mb-2",children:"Video Quality"}),e.jsxs("select",{value:E,onChange:e=>R(e.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded px-3 py-2 text-white",children:[e.jsx("option",{value:"HD",children:"HD (720p)"}),e.jsx("option",{value:"SD",children:"SD (480p)"}),e.jsx("option",{value:"LOW",children:"Low (240p)"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-300 text-sm",children:"Auto-adjust quality"}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"})]})]}),e.jsx("button",{onClick:()=>B(!1),className:"w-full bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg transition-colors",children:"Close Settings"})]})]}),r-T<2*a.pricePerMinute&&e.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-red-600/90 backdrop-blur-lg text-white px-6 py-4 rounded-lg border border-red-500 shadow-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-semibold mb-2",children:"âš ï¸ Low Balance Warning"}),e.jsxs("div",{className:"text-sm",children:["Your call will end in approximately ",Math.floor((r-T)/a.pricePerMinute)," minutes"]}),e.jsx("button",{className:"mt-3 bg-white text-red-600 px-4 py-2 rounded-lg font-semibold hover:bg-gray-100 transition-colors",children:"Add Coins Now"})]})})]}),e.jsx(N,{isOpen:A,onClose:()=>H(!1),modelName:a.name,modelAvatar:a.avatar,onSendGift:e=>{I(t=>t+e.value)}})]})};export{y as EnhancedVideoCall};
